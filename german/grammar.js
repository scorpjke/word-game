let strong_verbs = {};

`backen  bäckt/backte 	backte/buk  gebacken 	
befehlen  befiehlt  befahl 	befohlen 	
beginnen 	- 	begann 	begonnen 	2
beißen 	- 	biss 	gebissen 	
bergen 	birgt 	barg 	geborgen 	
bersten 	birst/berstet 	barst 	geborsten 	
bewegen 	- 	bewog 	bewogen 	
biegen 	- 	bog 	gebogen 	
bieten 	- 	bot 	geboten 	
binden 	- 	band 	gebunden 	
bitten 	- 	bat 	gebeten 	2
blasen 	bläst 	blies 	geblasen 	
bleiben 	- 	blieb 	geblieben 	1
braten 	brät 	briet 	gebraten 	
brechen 	bricht 	brach 	gebrochen 	2
brennen  	- 	brannte 	gebrannt 	
bringen  	- 	brachte 	gebracht 	1
denken  	- 	dachte 	gedacht 	1
dreschen 	drischt 	drosch 	gedroschen 	
dringen 	- 	drang 	gedrungen 	
dürfen  	darf 	durfte 	gedurft 	1
empfehlen 	empfiehlt 	empfahl 	empfohlen 	
erkiesen  	- 	erkor 	erkoren 	
erklimmen  	- 	erklomm 	erklommen 	
erlöschen 	erlischt 	erlosch 	erloschen 	
erschrecken 	erschrickt 	erschrak 	erschrocken 	
essen 	isst 	aß 	gegessen 	1
fahren 	fährt 	fuhr 	gefahren 	1
fallen 	fällt 	fiel 	gefallen 	2
fangen 	fängt 	fing 	gefangen 	2
fechten 	ficht 	focht 	gefochten 	
finden 	- 	fand 	gefunden 	1
flechten 	flicht 	flocht 	geflochten 	
fliegen 	- 	flog 	geflogen 	
fliehen 	- 	floh 	geflohen 	
fließen 	- 	floß 	geflossen 	
fressen 	frisst 	fraß 	gefressen 	
frieren 	- 	fror 	gefroren 	
gären 	- 	gärte/gor 	gegärt/gegoren 	
gebären 	gebärt/gebiert 	gebar 	geboren 	
geben 	gibt 	gab 	gegeben 	1
gedeihen 	- 	gedieh 	gediehen 	
gehen 	- 	ging 	gegangen 	1
gelingen 	- 	gelang 	gelungen 	
gelten 	gilt 	galt 	gegolten 	
genesen 	- 	genas 	genesen 	
genießen 	- 	genoss 	genossen 	
geschehen 	geschieht 	geschah 	geschehen 	
gewinnen 	- 	gewann 	gewonnen 	1
gießen 	- 	goss 	gegossen 	
gleichen 	- 	glich 	geglichen 	
gleiten 	- 	glitt 	geglitten 	
glimmen  	- 	glomm 	geglommen 	
graben 	gräbt 	grub 	gegraben 	
greifen 	- 	griff 	gegriffen 	
haben  	hat 	hatte 	gehabt 	1
halten 	hält 	hielt 	gehalten 	1
hängen 	- 	hing 	gehangen 	
hauen 	- 	hieb 	gehauen 	
heben 	- 	hob 	gehoben 	
heißen 	- 	hieß 	geheißen 	1
helfen 	hilft 	half 	geholfen 	1
kennen  	- 	kannte 	gekannt 	1
klingen 	- 	klang 	geklungen 	2
kneifen 	- 	kniff 	gekniffen 	
kommen 	- 	kam 	gekommen 	1
können  	kann 	konnte 	gekonnt 	1
kriechen 	- 	kroch 	gekrochen 	
laden 	lädt 	lud 	geladen 	2
lassen 	lässt 	ließ 	gelassen 	1
laufen 	läuft 	lief 	gelaufen 	1
leiden 	- 	litt 	gelitten 	
leihen 	- 	lieh 	geliehen 	
lesen 	liest 	las 	gelesen 	1
liegen 	- 	lag 	gelegen 	1
lügen 	- 	log 	gelogen 	
mahlen 	- 	mahlte 	gemahlen 	
meiden 	- 	mied 	gemieden 	
melken 	milkt/melkt 	melkte 	gemolken 	
messen 	misst 	maß 	gemessen 	
misslingen 	- 	misslang 	misslungen 	
mögen  	mag 	mochte 	gemocht 	1
müssen  	muss 	musste 	gemusst 	1
nehmen 	nimmt 	nahm 	genommen 	1
nennen  	- 	nannte 	genannt 	2
pfeifen 	- 	pfiff 	gepfiffen 	
preisen 	- 	pries 	gepriesen 	
quellen 	quillt 	quoll 	gequollen 	
raten 	rät 	riet 	geraten 	
reiben 	- 	rieb 	gerieben 	
reißen 	- 	riss 	gerissen 	
reiten 	- 	ritt 	geritten 	
rennen  	- 	rannte 	gerannt 	
riechen 	- 	roch 	gerochen 	
ringen 	- 	rang 	gerungen 	
rinnen 	- 	rann 	geronnen 	
rufen 	- 	rief 	gerufen 	2
salzen 	- 	salzte 	gesalzen 	
saufen 	säuft 	soff 	gesoffen 	
saugen 	- 	sog 	gesogen 	
schaffen 	- 	schuf 	geschaffen 	1
scheiden 	- 	schied 	geschieden 	
scheinen 	- 	schien 	geschienen 	1
scheißen 	- 	schiss 	geschissen 	
schelten 	schilt 	schalt 	gescholten 	
scheren 	- 	schor 	geschoren 	
schieben 	- 	schob 	geschoben 	
schießen 	- 	schoss 	geschossen 	
schinden 	- 	schindete 	geschunden 	
schlafen 	schläft 	schlief 	geschlafen 	1
schlagen 	schlägt 	schlug 	geschlagen 	
schleichen 	- 	schlich 	geschlichen 	
schleifen 	- 	schliff 	geschliffen 	
schließen 	- 	schloss 	geschlossen 	2
schlingen 	- 	schlang 	geschlungen 	
schmeißen 	- 	schmiss 	geschmissen 	
schmelzen 	schmilzt 	schmolz 	geschmolzen 	
schneiden 	- 	schnitt 	geschnitten 	2
schreiben 	- 	schrieb 	geschrieben 	1
schreien 	- 	schrie 	geschrien 	
schreiten 	- 	schritt 	geschritten 	
schweigen 	- 	schwieg 	geschwiegen 	
schwellen 	schwillt 	schwoll 	geschwollen 	
schwimmen 	- 	schwamm 	geschwommen 	2
schwinden 	- 	schwand 	geschwunden 	
schwingen 	- 	schwang 	geschwungen 	
schwören 	- 	schwor 	geschworen 	
sehen 	sieht 	sah 	gesehen 	1
sein  	is 	war 	gewesen 	1
senden  	- 	sandte 	gesandt 	
sieden  	- 	siedete/sott 	gesotten 	
singen 	- 	sang 	gesungen 	2
sinken 	- 	sank 	gesunken 	
sinnen 	- 	sann 	gesonnen 	
sitzen 	- 	saß 	gesessen 	1
sollen  	soll 	sollte 	gesollt 	1
spalten 	- 	spaltete 	gespalten/gespaltet 	
speien 	- 	spie 	gespien 	
spinnen 	- 	spann 	gesponnen 	
sprechen 	spricht 	sprach 	gesprochen 	1
sprießen 	- 	sproß 	gesprossen 	
springen 	- 	sprang 	gesprungen 	
stechen 	sticht 	stach 	gestochen 	
stehen 	- 	stand 	gestanden 	1
stehlen 	stiehlt 	stahl 	gestohlen 	
steigen 	- 	stieg 	gestiegen 	
sterben 	stirbt 	starb 	gestorben 	
stinken 	- 	stank 	gestunken 	
stoßen 	stößt 	stieß 	gestoßen 	
streichen 	- 	strich 	gestrichen 	
streiten 	- 	stritt 	gestritten 	
tragen 	trägt 	trug 	getragen 	1
treffen 	trifft 	traf 	getroffen 	2
treiben 	- 	trieb 	getrieben 	
treten 	- 	tritt 	getreten 	
trinken 	- 	trank 	getrunken 	1
trügen 	- 	trog 	getrogen 	
tun 	- 	tat 	getan 	1
verderben 	verdirbt 	verdarb 	verdorben 	
verdrießen 	- 	verdross 	verdrossen 	
vergessen 	vergisst 	vergaß 	vergessen 	1
verlieren 	- 	verlor 	verloren 	1
verzeihen 	- 	verzieh 	verziehen 	
wachsen 	wächst 	wuchs 	gewachsen 	
wägen 	- 	wog 	gewogen 	
waschen 	wäscht 	wusch 	gewaschen 	2
weichen 	- 	wich 	gewichen 	
weisen 	- 	wies 	gewiesen 	
wenden  	- 	wandte 	gewandt 	
werben 	wirbt 	warb 	geworben 	
werden  	wird 	wurde 	geworden 	1
werfen 	wirft 	warf 	geworfen 	
wiegen 	- 	wog 	gewogen 	
winden 	- 	wand 	gewunden 	
wissen  	weiß 	wusste 	gewusst 	1
wollen  	will 	wollte 	gewollt 	1
wringen 	- 	wrang 	gewrungen 	
ziehen 	- 	zog 	gezogen 	1
zwingen 	- 	zwang 	gezwungen    `
.split('\n').forEach(function(line){
    line = line.split(/[\t ]+/);
    if (line.length == 0) return;
    let res = {};
    if (line[1] != '-') res.special_v_er = line[1];
    res.v2 = line[2];
    res.v3 = line[3];

    //if (line[4]) res.irr_diff = parseInt(line[4]);
    strong_verbs[line[0]] = res;
});



class Verb {
    constructor(verb) {
        let V = this;
        
        //console.log(verb);
        let s = `(kn|pf|str?|spr?|sch[lmnrw]?|[tdkgpbf]r|[kgfbp]l|pfl|zw|qu|ch|[wrtpsdfghjklzvbnm])?[aiueoäüö]`;
        let p = '(' + Verb.all_pref.join('|') + ')';
        let found = verb.match(`^${p}*(${s}.+)(en)`) || verb.match(`^${p}*(${s}.*e[rl])(n)`) || verb.match(`^${p}*((t)u)(n)`) || verb.match(`^${p}*((s)ei)(n)`);

        V.stem = found[2];
        V.rest = found[2] + found[4];

        V.sep_pref = [];
        V.insep_pref = [];

        if (found[1]) {
            let prefixes = verb.slice(0, verb.length - V.rest.length).replace( new RegExp(p, 'g'), '$1 ').trim().split(' ');
            V.number_of_prefixes = prefixes.length;

            let s = V.sep_pref;

            for (let pr of prefixes) {
                if (Verb.insep_pref.includes(pr) ) s = V.insep_pref;
                s.push(pr);
            }
        }
        V.sep_pref = V.sep_pref.join('');
        V.insep_pref = V.insep_pref.join('');

        
        if (V.sep_pref) {
            V.prefix_type = V.insep_pref ? 'both' : 'sep';
        }
        else if (V.insep_pref) V.prefix_type = 'insep';
        else V.prefix_type = 'none';

        let found2 = strong_verbs[verb] || strong_verbs[V.insep_pref + V.rest] || strong_verbs[V.rest];
        
        if (found2) {
            Object.assign(V, found2);
            //if (!V.irr_diff) V.irr_diff = 3;
            V.irr_diff = true;

            if (V.special_v_er && !V.special_v_er.match(/[td]$/))
                V.modal = true;
        }
        else {
            V.irr_diff = false;
            let t = smart_unite(V.stem, 't');
            V.v2 = t + 'e';
            V.v3 = 'ge' + t;
        }
        
        function detach(w, pref) {
            return w.replace(new RegExp(`^${pref}`), '');
        }

        if (V.insep_pref) {
            if (V.special_v_er)
                V.special_v_er = detach(V.special_v_er, V.insep_pref); 

            V.v2 = detach(V.v2, V.insep_pref);
            V.v3 = detach(V.v3, 'ge');
            V.v3 = detach(V.v3, V.insep_pref);
        }
        if (V.stem.match(/ier$/)) V.v3 = detach(V.v3, 'ge');
    }

    make(tense, person) {
        let V = this;
        let res = [];
        let p;

        if (tense == 'inf') return [V.sep_pref + V.insep_pref + V.rest];
        else if (tense == 'zu-inf') {
            if (V.sep_pref) return [V.sep_pref + 'zu' + V.insep_pref + V.rest];
            else return ['zu', V.insep_pref + V.rest];
        }
        else if (tense == 'past participle') return [V.sep_pref + V.insep_pref + V.v3];
        
        if (['ich','du','ihr','wir','sie'].includes(person)) p = person;
        else p = 'er';

        let res_stem = V.stem;
        let res_ending = Verb.standard_endings[p];

        if (tense == 'present') {
            if (V.rest == 'sein') {
                res.push({'ich':'bin', 'du':'bist', 'er':'ist', 'wir':'sind', 'ihr':'seid', 'sie':'sind'}[p]);
            }
            else if (p == 'ich' && V.modal) {
                res.push(V.special_v_er);
            }
            else if (V.special_v_er && (p == 'du' || p == 'er')) {
                if (p == 'er') res.push(V.special_v_er);
                else res_stem = V.special_v_er.replace(/[td]$/, '');
            }
            else if (p == 'sie' || p == 'wir')
                res.push(V.rest);
        }
        else if (tense.includes('perfect')) {
            let time = tense.split(' ')[0];
            let aux = 'haben';
            if (Verb.verbs_that_use_sein.includes(V.rest) || Verb.verbs_that_use_sein.includes(V.in('inf'))) {
                aux = 'sein';
            }
            aux = new Verb(aux).make(time, p);
            
            if (time == 'future') aux = [aux[0], V.in('past participle'), aux[1]];
            else aux.push(V.in('past participle'));

            return aux;
        }
        else if (tense == 'future') {
            let aux = new Verb('werden').make('present', p);
            aux.push(V.in('inf') );
            return aux;
        }
        else if (tense == 'fake subjunctive') {
            let aux = new Verb('würden').make('present', p);
            aux.push(V.in('inf') );
            return aux;
        }
        else if (tense == 'real subjunctive') {
            res_stem = umlautify(V.v2.replace(/e$/, ''));
            let tr = {'du':'est', 'er':'e', 'ihr':'et'};
            if (tr[p]) res_ending = tr[p];
        }
        else if (tense == 'subjunctive') {
            return V.make( (V.modal || ['haben','sein'].includes(V.rest) ? 'real':'fake') + ' subjunctive', person);
        }
        else if (tense == 'preterite' || tense == 'past simple') {
            if (p == 'ich' || p == 'er') res.push(V.v2);
            else res_stem = V.v2.replace(/e$/, '');
        }

        if (res.length == 0) res.push(smart_unite(res_stem, res_ending));

        if (V.insep_pref) res[0] = V.insep_pref + res[0];
        if (V.sep_pref) res.push(V.sep_pref);
        
        return res;
    }

    in(tense, person) {
        return this.make(tense, person).join(' ');
    }

    full_conjugation() {
        for (let form of ['inf', 'zu-inf', 'past participle']) {
            console.log('---------' + form + '---------');
            console.log(this.in(form));
        }
        for (let tense of ['present','present perfect', 'future', 'future perfect', 'preterite', 'preterite perfect', 'subjunctive', 'subjunctive perfect']) {
            console.log('---------' + tense + '---------');
            for (let person of ['ich','du','er','wir','ihr','sie']) {
                console.log([person].concat(this.make(tense,person)).join(' '));
            }
        }
    }
}

Verb.sep_pref = "ab an auf aus bei bevor durch ein fest fort gegen hinter hin her los mit nach statt vor weg weiter wieder zusammen zurück zu".split(' ');
Verb.insep_pref = "be emp ent er ge miss über un unter um wider ver voll zer".split(' ');
Verb.all_pref = Verb.sep_pref.concat(Verb.insep_pref).sort( (a,b) => a.length < b.length );

Verb.verbs_that_use_sein = `aufwachen bleiben erscheinen ertrinken fahren fallen fliegen folgen gebren gehen gelingen geschehen joggen klettern kommen kriechen laufen passieren reisen reiten rennen schlafen schwimmen sein sinken springen steigen sterben treten wachsen wandern werden`.split(' ');
Verb.standard_endings = {'ich':'e', 'du':'st', 'er':'t', 'ihr':'t', 'wir':'en', 'sie':'en'};


function smart_unite(stem, ending) {
    if (stem.match(/[td]$/) && ending.match(/^s?t/) )
        return stem + 'e' + ending;
    else if (stem.match(/[szß]$/) && ending.match(/^s/) )
        return stem + ending.slice(1);
    else if (stem.match(/(ch|[ptkbdgfslrzw])[nm]$/) && ending.match(/^s?t/) )
        return stem + 'e' + ending;
    
    return stem + ending;
}



let noun_phrase_parser_code =
`
Expression 
= sentence

sentence = (noun_phrase / word / any_symbol)+

noun_phrase
  = prep:prep ? ws:ws ? adjs:(adj*) noun:noun
{
  if (prep === null && ws === null) return noun;
  let orig_prep = prep;
  if ( ["im","am","vom"].includes(prep) ) {ws={stem:"d",ending:"em"};prep=prep.slice(0,-1)+"n"}
  else if ( ["zum","beim","vorm","unterm"].includes(prep) ) {ws={stem:"d",ending:"em"};prep=prep.slice(0,-1)}
  else if ( ["aufs", "ins", "ums", "durchs", "ans",  "fürs", "vors", "übers", "unters"].includes(prep) ) {ws={stem:"d",ending:"as"};prep=prep.slice(0,-1)}
  return {orig_prep,prep,ws,adjs,noun, location:location()};
}
/ prep:prep ? pronoun:pronoun {return {prep, pronoun, location:location()}}

pronoun = p:("du" / "dir" / "dich" / "ich" / "mir" / "mich" / "euch" / "sie" / "ihr" / "ihnen" /  "Sie" / "Ihr" / "Ihnen" / "wir" / "uns" / "er" / "ihm" / "ihn") _ {return p}

prep = p:$("zu" "m"? / "zur" / "bei" "m"? / "von" / "vom" / "vor" "m"? / "unter" "m"? /
("auf" / "in" / "um" / "durch" / "an" /  "für" / "vor" / "über" / "unter") "s"?
/ "mit"  / "nach" / "am" / "im" ) _ {return p}

ending "ending"
= e:("en" / "em" / "es" / "er" / "e") _ {return e}

der_word = stem:("d" / "welch" / "jed") ending:ending {return {stem, ending }} / ex:("das"/"die") _ {return {stem:'d',ending:ex.slice(1)} }
ein_word = stem:("kein" / "mein" / "dein" / "sein" / "unser" / "euer" / "eur" / "ihr" / "ein") ending:$(ending / _ ) {return {stem, ending: ending.trim() } }
ws = (der_word / ein_word)

noun = n:$(cap_letter letter+) _ {return n}

adj = ending:ending {return {ending}} / letter:small_letter tail:adj {
if (tail.stem) return {stem: letter+tail.stem, ending:tail.ending}
if (tail.ending) return {stem: letter, ending:tail.ending}
}

consonant = [ptkbdgfslrzw]
small_letter = [a-zäüöß]
cap_letter = [A-ZÄÜÖ]
letter = [A-zÄäÜüÖöß]
any_symbol = .
word = w:$(letter+) _ {return w}

_ "whitespace"
  = [ \\t\\n\\r]+
`;

let noun_phrase_parser = peg.generate(noun_phrase_parser_code);

let strong_endings = {
    nom: {m: 'er', n: 'es', f: 'e', p: 'e'},
    acc: {m: 'en', n: 'es', f: 'e', p: 'e'},
    dat: {m: 'em', n: 'em', f: 'er', p: 'en'},
    gen: {m: 'es', n: 'es', f: 'er', p: 'er'},
};

//personal pronouns! ich mich mir

let personal_pronouns = {
    ich: {acc: 'mich', dat: 'mir'},
    du: {acc: 'dich', dat: 'dir'},
    er: {acc: 'ihn', dat: 'ihm'},
    sie: {acc: 'sie', dat: 'ihr/ihnen'},
    es: {acc: 'es', dat: 'ihm'},
    wir: {acc: 'uns', dat: 'uns'},
    ihr: {acc: 'euch', dat: 'euch'},
    Sie: {acc: 'Sie', dat: 'ihnen'},
};

let ein_words = 'ein kein mein dein sein unser euer ihr'.split(' ');

let prep_dat = 'zu in auf mit'.split(' ');
let prep_acc = 'für um durch über ohne bis gegen'.split(' ');
let prep_gen = 'während wegen anstatt laut trotz'.split(' ');
let all_preps = prep_dat.concat(prep_acc).concat(prep_gen);

function prep_to_case(prep) {
    if (prep_acc.includes(prep)) return 'acc';
    if (prep_gen.includes(prep)) return 'gen';
    return 'dat';
}

function combine(prep, article) {
    if (article == 'das' && 'an in für auf um durch vor über unter'.includes(prep) ) return prep+'s';
    else if (article == 'dem' && 'an in bei von zu vor unter'.includes(prep) ) return prep.slice(-1) == 'n' ? prep.slice(0,-1)+'m': prep+'m';
    else if (article == 'der' && prep == 'zu') return 'zur';
    return prep + ' ' + article;
}

function apply_strong_ending(word, kase, gender) {
    let ending = strong_endings[kase][gender];

    if (word == 'der') {
        if (ending == 'e') return 'die';
        else if ( ['nom','acc'].includes(kase) && gender == 'n') return 'das';
        return 'd' + ending;
    }
    else if (ein_words.includes(word) && kase == 'nom' && 'mn'.includes(gender)) return word;

    return word + ending;
}

function apply_weak_ending(word, kase, gender) {
    if ( kase == 'acc' && gender == 'm' ) return word + 'en';
    if ( ['nom','acc'].includes(kase) && gender != 'p' ) return word + 'e'
    return word + 'en';
}


function umlautify(stem) {
    return stem.replace(/eu/, '蠍').replace(/([aou])/i, '$1\u0308').replace(/蠍/, 'eu');
}

let plural_er = 'Mann Kind Haus Mund'.split(' ');
let plural_e = 'Maus Nacht';

function make_plural(noun, gender) {
    let last = noun.slice(-1);
    if ( last == 'e' ) return noun+'n';
    if (noun.match(/e[rnl]$/) || noun.endsWith('chen') ) return umlautify(noun);
    if ( gender == 'f' && !plural_e.includes(noun) ) return noun+'en';
    if ( 'aiuoy'.includes(last) ) return noun + 's';

    let ending = plural_er.includes(noun) ? 'er' : 'e';
    return umlautify(noun) + ending;
}

function noun_declension(word, is_plural, kase) {
    if ( personal_pronouns[word] ) return personal_pronouns[word][kase];
    if (kase == 'dat' && is_plural && word.slice(-1) != 'n' ) return word + 'n';
    return word;
}

function find_noun_phrase(sentence) {

}

for (let s of ['ich habe deine Vater gesehen', 'er muss mit dem Arzt sprachen'])
    find_noun_phrase(s);

/*
function noun_phrase_declension(arr, kase, gender) {
    let res = [];
    if (arr[arr.length-1] )
    res.push( noun_declension(arr[arr.length-1], gender=='p', kase) );
    if (arr.length == 1) return res;
    
    for (let i = arr.length-2; i > 0; i++) {
        res.push( apply_weak_ending(arr[i],kase,gender) );
    }

    apply_strong_ending(arr[0])
}*/

let sentences_db = [];

function capitalize(sentence) {
    return sentence[0].toUpperCase() + sentence.slice(1);
}

function decapitalize(sentence) {
    return sentence[0].toLowerCase() + sentence.slice(1);
}

function pull_out_sentences(text) {
    return text.replace(/([?!.;]+)\s*/g, '$1蠍').split('蠍').filter(x => x.length > 1);
}


sentences_db = sentences_db.concat(pull_out_sentences(`
Vor kurzem sind wir umgezogen. „Wir“ – das sind mein Mann und ich und unsere zwei Kinder. Zuerst wollten wir nur eine größere Wohnung, um zu Viert mehr Platz zu haben. Dann sind wir aber zufällig auf ein kleines Haus mit einem kleinen Garten gestoßen und haben uns sofort darin verliebt und uns dafür entschieden, dort einzuziehen.

Jetzt kann jedes Kind ein eigenes Zimmer haben und es gibt sogar ein Büro für die beiden Eltern. Noch dazu werden wir einen Sandkasten im Garten einrichten, sodass die Kinder dort spielen können mit den Freunden, die sie hoffentlich in der Umgebung finden.

Im Moment gibt es noch ein großes Durcheinander im Haus, viele Kartons sind noch nicht ausgepackt, aber das wird sich bald ändern. Wir sind alle sehr froh.

 ich habe vor wenigen Wochen eine neue Jeans bei Ihnen bestellt. Ich war sehr glücklich, die Hose ist nach wenigen Tagen schon angekommen. Sie sieht aus wie in der Werbung und gefällt mir sehr. Leider haben Sie mir die Jeans in der falschen Größe geschickt. Die Hose passt mir nicht und ich kann sie daher nicht tragen. Ich bitte Sie daher um einen Umtausch der Ware.

Bitte schicken Sie mir per Post eine neue Jeans in der richtigen Größe zu. Ich schicke Ihnen dann die falsche Hose per Post zurück. Falls sie die Hose nicht in meiner Größe vorrätig haben, möchte ich gern mein Geld zurück.

Der Müritzsee ist das größte Gewässer in Deutschland. Er liegt im Bundesland Mecklenburg-Vorpommern. Der Bodensee ist noch größer als der Müritzsee. Er liegt jedoch nicht komplett in Deutschland. Große Teile des Bodensees liegen in der Schweiz und in Österreich.

Im Sommer ist der Müritzsee ein beliebtes Reiseziel. Er ist über 3,5 Kilometer lang. An einigen Stellen ist der See bis zu 750 Meter breit. Gäste fahren aus ganz Deutschland an den See. Viele Gäste kommen auch nur für einen Tag an den Müritzsee. Die Bundeshauptstadt Berlin liegt mit dem Auto nur 90 Minuten entfernt. Größere Städte am Ufer des Sees sind Waren und Röbel.

Heute ist Freitag. Wir haben heute Morgen in unseren Kühlschrank geschaut und gesehen, dass er leer ist. Da wir am Wochenende viele von unseren Freunden zu einer Party eingeladen haben, müssen wir nun einen Großeinkauf machen.

Unsere Freunde sind sehr unterschiedlich, einige möchten gerne alkoholische Getränke, andere lieber nur Saft oder Wasser. Also müssen wir viele verschiedene Sachen einkaufen. Wir haben entschieden, einige Salate zu machen, sodass wir nun viel Obst und Gemüse kaufen.

Wenn das Wetter schön ist, könnten wir auch einen Grill auf den Balkon stellen. Das bedeutet, wir müssen auch Würstchen und ein bisschen Fleisch kaufen, damit alle Gäste zufrieden sind. Wir hoffen, dass es ein schönes Fest wird. 

Im Sommer reisen viele Menschen gerne nach Österreich. Besonders in Wien und Salzburg treffen sich Touristen aus aller Welt, um auf Konzerte zu gehen, Museen zu besuchen und außerhalb der Städte kurze Wanderungen zu unternehmen. In Wien besuchen die Touristen am liebsten den Stephansdom und das Schloss Schönbrunn; in Salzburg besonders die Festung Hohensalzburg und das Haus, in dem der Komponist Wolfgang Amadeus Mozart geboren wurde.

Wer nach Österreich reist, schläft gerne im Hotel, deswegen sind manche Hotels im Sommer ausgebucht. Andere Leute übernachten gerne in Jugendherbergen oder mieten Wohnungen, in denen sie sich selbst versorgen müssen. Im Internet vergleichen sie die Preise und finden so das günstigste und das für sie beste Angebot in der Stadt. Überrascht sind sie oft, weil die Supermärkte in Österreich am Wochenende und in der Nacht nicht geöffnet sind. Trotzdem gefällt es den meisten Touristen in Wien und Salzburg sehr gut, schließlich kommen viele auch gerne wieder nach Österreich zurück.

Tina ist neu in der Stadt und kennt sich noch nicht aus. Sie möchte gerne etwas zu essen und zu trinken kaufen, weiß aber nicht, wo sie einkaufen kann.

Im Treppenhaus trifft sie ihren neuen Nachbarn Ben. "Hallo, ich bin Ben. Bist du neu hier?", fragt Ben. "Ja, ich wohne erst seit gestern hier. Ich heiße Tina. Kannst du mir sagen, wo der nächste Supermarkt ist?", möchte Tina wissen. "Lass uns zusammen gehen, ich wollte auch gerade los und ein paar Kleinigkeiten besorgen. Dann kann ich dir den Weg zeigen." "Das klingt gut, danke."

Also machen die beiden sich gemeinsam auf den Weg zum Supermarkt, um ihre Einkäufe zu erledigen.

Wir fahren in den Ferien immer ans Meer. Wir baden gerne und freuen uns über die Wellen. Besonders wenn die Sonne scheint und es richtig heiß ist, fühlen wir uns am Meer sehr wohl. Das Wasser ist kühl und wir können auch am Strand im Schatten liegen und ein interessantes Buch lesen. Muscheln suchen macht uns viel Spaß oder wir bauen eine große Burg. Dort können wir dann auch unsere Handtücher ausbreiten.

Wenn das Wetter nicht so schön ist, gehen wir am Meer spazieren oder wir gehen in die nächste Stadt und machen einen Einkaufsbummel. Ein Urlaub am Meer ist für uns immer gut für eine Pause im Sommer. 

Heute ist der 30. Juli. Übermorgen habe ich meinen zwanzigsten Geburtstag und ich habe eine große Party geplant. Zu meiner Feier habe ich zwanzig Leute eingeladen, für die ich kochen werde. Als ich heute in den Kühlschrank sah, stellte ich aber fest, dass er schon fast leer ist. Ich muss jetzt einen Großeinkauf machen: Meine Freunde mögen ganz unterschiedliche Sachen, daher ist die Einkaufsliste sehr lang.

Viele von ihnen trinken gerne alkoholische Getränke wie Bier und Wein. Für andere kaufe ich Wasser und Fruchtsaft ein. Wenn wir grillen, muss ich auch aufpassen, dass meine vegetarischen Freunden etwas Gutes zu essen bekommen. Für sie werde ich einen guten Salat vorbereiten und Käse zum Grillen kaufen. Die anderen Freunde essen gerne Würstchen und Steaks.

Wenn die Sonne scheint, können wir bis spät in die Nacht im Garten sitzen und uns gut unterhalten. Ich freue mich schon auf das Fest und ich hoffe, dass es meinen Freunden auch viel Spaß machen wird.

Anna und Stefan ziehen heute um. Bisher hat Anna in München studiert und Stefan hat in Bremen als Ingenieur gearbeitet. Jetzt hat Anna eine Arbeit in Hamburg gefunden und das Paar hat sich entschieden zusammenzuziehen.

Mit dem Umzugswagen bringen Anna und Stefan ihre Möbel und alles was sonst noch dazu gehört in ihre neue gemeinsame Wohnung. Die neue Wohnung hat 3 Zimmer und ist schön groß. Das Wohnzimmer ist der größte Raum. Dann gibt es noch ein Schlafzimmer und ein Kinderzimmer. Dieses wird erstmal als Büro dienen. Das Badezimmer hat eine Dusche, eine Badewanne und ein großes Fenster.

Ihre Freunde helfen den beiden beim Umzug. Am Abend wird gegrillt und alle freuen sich, dass der Umzug geschafft ist.

Viele Leute lieben Einkaufszentren. Auch wenn man nicht unbedingt etwas kaufen möchte, gibt es immer etwas zu sehen. Im Winter ist es warm und im Sommer kühl. Man kann durch die Galerien schlendern und sich die Angebote anschauen. Vielleicht findet man ja doch etwas Interessantes, oder etwas, was man schon lange gesucht hat.

Auch wenn man mit Freunden in ein Einkaufszentrum geht, macht das Spaß. Da es in den meisten Zentren auch Cafés und Eisdielen gibt, kann man sich zusammensetzen und ein bisschen diskutieren, ohne vom Wetter abhängig zu sein. In einem Einkaufszentrum kann man alle verschiedenen Arten von Geschäften an einem Ort finden und muss nicht von einem zum anderen gehen oder fahren. Es gibt ebenso Lebensmittel wie Kleider oder Haushaltswaren und Drogerieartikel. 

Mein Name ist Nadja Müller. Jeden Tag stehe ich um 6:00 Uhr auf. Noch bevor ich ins Bad gehe, schalte ich die Kaffeemaschine ein. Ohne meinen Kaffee am Morgen habe ich den ganzen Tag schlechte Laune. Das ist nicht gut für meinen Job.

Ich arbeite in einem Kindergarten und da gehört gute Laune sozusagen zur Berufsbeschreibung dazu. Die Kinder sind sehr neugierig und lernen gerne durch Spiele und Geschichten. Wir lesen und singen, malen und basteln und wenn die Kleinen ihren Mittagsschlaf machen, kümmern wir Erzieherinnen uns um die Büroarbeit.

Abends nach der Arbeit treffe ich mich oft mit Freunden oder gehe zum Sport. Am Wochenende kann ich gut abschalten und entspannen.
`));

let orig_form = {
    'mir':'ich', 'mich':'ich',
    'dir':'du', 'dich':'du',
    'ihr':'sie',
    'ihn':'er', 'ihm':'er',
    'uns':'wir', 'euch':'ihr'
};
/*
function print_parsed(d, hide_prep) {
    let res = '';
    for (let token of d) {
        if (typeof token === "string") res+= token + ' ';
        else {
            let words = [];
            if (token.chosen) words.push("(");
            if (token.orig_prep != token.prep && !token.chosen) words.push(token.orig_prep);
            else {
                if (token.chosen && hide_prep) words.push('<possible prep>');
                else if (token.prep) words.push(token.prep);
                if (token.ws) words.push(token.ws.stem + (token.chosen ? '...' : token.ws.ending) );
            }
            if (token.adjs) for (let a of token.adjs) words.push(a.stem + (token.chosen ? '...' : a.ending));
            if (token.pronoun) {
                if (token.chosen) words.push(orig_form[token.pronoun] || token.pronoun);
                else words.push(token.pronoun);
            }
            if (token.chosen) words.push(")");
            if (token.noun) words.push(token.noun);
            res += words.join(' ') + ' ';
        }
    }
    return capitalize(res) ;
}
*/

//sentences_db = ["In Wien besuchen die Touristen am liebsten den Stephansdom und das Schloss Schönbrunn; in Salzburg besonders die Festung Hohensalzburg und das Haus, in dem der Komponist Wolfgang Amadeus Mozart geboren wurde."];

function make_answer(token) {
    let words = [];
    if (token.orig_prep != token.prep) words.push(token.orig_prep);
    else {
        if (token.prep) words.push(token.prep);
        if (token.ws) words.push(token.ws.stem + token.ws.ending );
    }
    if (token.adjs) for (let a of token.adjs) words.push(a.stem + a.ending);
    if (token.pronoun) words.push(token.pronoun);
    return words.join(' ');
}

function make_question(token) {
    let words = [];

    if (token.prep) words.push(token.prep);
    if (token.ws) words.push(token.ws.stem + '...' );

    if (token.adjs) for (let a of token.adjs) words.push(a.stem + '...');

    if (token.pronoun) {
        words.push(orig_form[token.pronoun] || token.pronoun);
    }
    return '( ' + words.join(' ') + ' )';
}

function make_ending_task() {
    let s_orig = sentences_db.random().trim();
    let s = s_orig.replace(/([A-zÄäÜüÖöß]+) ?/g, '$1 ');
    s = decapitalize(s.trim());
    let d = noun_phrase_parser.parse(s);

    let task_np = d.filter(t => typeof t === 'object').random();
    if (!task_np
        || task_np.prep && task_np.pronoun == 'ihr'
        || !task_np.pronoun && task_np.adjs.length == 0 && !task_np.ws
        || ['Sie', 'Ihr', 'Ihnen'].includes(task_np.noun)
    ) return make_ending_task();
    
    //console.log(task_np);
    let answer = make_answer(task_np);
    let offset = task_np.location.start.offset - 5; if (offset < 0) offset = 0;
    let question = s_orig.slice(0, offset) +  s_orig.slice(offset).replace(new RegExp(`\\b`+answer+`\\b`, 'i'), make_question(task_np) );
    
    //let question = make_question(task_np) + s_orig.slice(offset + answer.length);

    return {question, answer};
}


function make_put_the_word_back_task() {
    let word_arr = [];
    let s = sentences_db.random().trim().replace(/[A-zÄäÜüÖöß]+/g, function(word){
        word_arr.push(word);
        return word+'燕'+word_arr.length;
    });

    let rn = Math.floor(Math.random()*word_arr.length);

    s = s.replace(new RegExp("[A-zÄäÜüÖöß]+燕"+(rn+1) ), '').replace(/  /, ' ').replace(/ ([.!,?:])/, '$1').trim().replace(/([A-zÄäÜüÖöß]+)燕[0-9]+/g, '$1');
    s = capitalize(s);

    let missing_word = word_arr[rn];
    let answer_w = word_arr[rn-1] || null;
    if (word_arr.filter(w => w == answer_w).length > 1) answer_w = null;

    return {sentence:s, missing_word, answer_n: rn+1, answer_w};
}